<!DOCTYPE html>
<html lang='en'>
<head>
  <meta charset='UTF-8'>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Active Directory Health Dashboard</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body { 
      background: linear-gradient(135deg, #1e1e2f 0%, #2a2a3d 100%);
      color: #e0e0e0; 
      font-family: 'Segoe UI', Tahoma, sans-serif; 
      padding: 20px;
      min-height: 100vh;
    }
    .container { max-width: 1400px; margin: 0 auto; }
    header { 
      text-align: center; 
      padding: 30px 20px; 
      background: rgba(0,0,0,0.3);
      border-radius: 15px;
      margin-bottom: 30px;
      box-shadow: 0 8px 32px rgba(0,0,0,0.3);
    }
    h1 { 
      color: #00ffff; 
      font-size: 2.5em; 
      margin-bottom: 10px;
      text-shadow: 0 0 20px rgba(0,255,255,0.5);
    }
    .subtitle { color: #00ff99; font-size: 1.2em; margin-top: 10px; }
    .summary-cards {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 20px;
      margin-bottom: 30px;
    }
    .summary-card {
      background: rgba(42,42,61,0.8);
      padding: 25px;
      border-radius: 12px;
      text-align: center;
      border: 2px solid #444;
      box-shadow: 0 4px 16px rgba(0,0,0,0.2);
      transition: transform 0.3s ease, box-shadow 0.3s ease;
    }
    .summary-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 8px 24px rgba(0,0,0,0.4);
    }
    .summary-card h3 { color: #00ffff; margin-bottom: 15px; font-size: 1.1em; }
    .summary-card .value { font-size: 2.5em; font-weight: bold; margin: 10px 0; }
    .summary-card.success .value { color: #00ff00; }
    .summary-card.warning .value { color: #ffa500; }
    .summary-card.critical .value { color: #ff4444; }
    .summary-card.info .value { color: #00ffff; }
    
    .chart-section {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(500px, 1fr));
      gap: 20px;
      margin-top: 50px;
      margin-bottom: 30px;
    }
    .chart-container {
      background: rgba(42,42,61,0.8);
      padding: 25px;
      border-radius: 12px;
      border: 2px solid #444;
      box-shadow: 0 4px 16px rgba(0,0,0,0.2);
    }
    .chart-container h2 { 
      color: #00ff99; 
      margin-bottom: 20px; 
      font-size: 1.4em;
      text-align: center;
    }
    
    h2 { 
      color: #00ff99; 
      margin: 30px 0 20px 0; 
      font-size: 1.8em;
      padding-bottom: 10px;
      border-bottom: 2px solid #444;
    }
    table { 
      width: 100%; 
      border-collapse: collapse; 
      margin-top: 10px;
      background: rgba(42,42,61,0.8);
      border-radius: 12px;
      overflow: hidden;
      box-shadow: 0 4px 16px rgba(0,0,0,0.2);
    }
    th, td { 
      border: 1px solid #555; 
      padding: 12px 8px; 
      text-align: center; 
    }
    th { 
      background-color: #2a2a3d; 
      color: #00ffff; 
      font-weight: 600;
      position: sticky;
      top: 0;
      z-index: 10;
    }
    tr:nth-child(even) { background-color: rgba(46,46,64,0.5); }
    tr:hover { background-color: rgba(60,60,80,0.7); }
    
    .pass { color: #00ff00; font-weight: bold; }
    .warn { color: #ffa500; font-weight: bold; }
    .fail { color: #ff4444; font-weight: bold; }
    .na { color: #999; }
    
    .dc-health-list {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
      gap: 15px;
      margin-bottom: 30px;
    }
    .dc-health-item {
      background: rgba(42,42,61,0.8);
      padding: 20px;
      border-radius: 10px;
      border-left: 5px solid;
      box-shadow: 0 4px 16px rgba(0,0,0,0.2);
    }
    .dc-health-item.healthy { border-left-color: #00ff00; }
    .dc-health-item.warning { border-left-color: #ffa500; }
    .dc-health-item.critical { border-left-color: #ff4444; }
    .dc-health-item h3 { 
      color: #00ffff; 
      margin-bottom: 10px;
      font-size: 1.1em;
    }
    .dc-health-item .score {
      font-size: 2em;
      font-weight: bold;
      margin: 5px 0;
    }
    
    .failure-section {
      background: rgba(42,42,61,0.8);
      padding: 25px;
      border-radius: 12px;
      margin-bottom: 20px;
      border: 2px solid #ff4444;
      box-shadow: 0 4px 16px rgba(255,68,68,0.2);
    }
    .failure-section h3 { 
      color: #ff6666; 
      margin-bottom: 15px;
      font-size: 1.3em;
    }
    .failure-section h4 { 
      color: #ffa500; 
      margin-top: 15px; 
      margin-bottom: 10px;
    }
    .failure-section pre { 
      background: rgba(0,0,0,0.3); 
      padding: 15px; 
      border-radius: 8px; 
      overflow-x: auto;
      color: #e0e0e0;
      border-left: 3px solid #ff4444;
      line-height: 1.5;
    }
    
    footer { 
      text-align: center; 
      margin-top: 50px; 
      padding: 20px;
      font-size: 0.9em; 
      color: #888;
      border-top: 2px solid #444;
    }
    
    .status-badge {
      display: inline-block;
      padding: 4px 12px;
      border-radius: 12px;
      font-size: 0.85em;
      font-weight: bold;
    }
    .status-badge.pass { background: #00ff0033; color: #00ff00; }
    .status-badge.warn { background: #ffa50033; color: #ffa500; }
    .status-badge.fail { background: #ff444433; color: #ff4444; }
    
    @media (max-width: 768px) {
      .chart-section { grid-template-columns: 1fr; }
      .summary-cards { grid-template-columns: 1fr; }
      h1 { font-size: 1.8em; }
    }
  </style>
</head>
<body>
  <div class="container">
    <header>
      <h1>🖥️ Active Directory Health Dashboard</h1>
      <div class="subtitle">Generated on <strong>16 February 2026 11:41</strong></div>
    </header>
    
    <div class="summary-cards">
      <div class="summary-card info">
        <h3>Domain Controllers</h3>
        <div class="value">2</div>
      </div>
      <div class="summary-card success">
        <h3>Critical Issues</h3>
        <div class="value">0</div>
      </div>
      <div class="summary-card warning">
        <h3>Warnings</h3>
        <div class="value">1</div>
      </div>
      <div class="summary-card info">
        <h3>Overall Health</h3>
        <div class="value">98%</div>
      </div>
    </div>    
    <h2>📊 Domain Controller Performance Metrics</h2>
    <table>
      <tr>
        <th>Server</th>
        <th>Site</th>
        <th>OS Version</th>
        <th>Uptime (h)</th>
        <th>CPU %</th>
        <th>Memory %</th>
        <th>Disk Free</th>
        <th>AD DB (GB)</th>
        <th>Network (Mbps)</th>
      </tr>      <tr>
        <td><strong>dc01.HomeLAN.internal</strong><br><small style='color: #888;'>→ Stable</small></td>
        <td>Default-First-Site-Name</td>
        <td><small>Microsoft Windows Server 2025 Datacenter 10.0.26100</small></td>
        <td>13.5</td>
        <td class='pass'>3%</td>
        <td class='pass'>62.5%</td>
        <td class='pass'>35.93 GB (61.6%)</td>
        <td>0.04</td>
        <td>0</td>
      </tr>      <tr>
        <td><strong>dc02.HomeLAN.internal</strong><br><small style='color: #888;'>→ Stable</small></td>
        <td>Default-First-Site-Name</td>
        <td><small>Microsoft Windows Server 2025 Datacenter 10.0.26100</small></td>
        <td>13.5</td>
        <td class='pass'>2%</td>
        <td class='pass'>58.8%</td>
        <td class='pass'>37.84 GB (64.8%)</td>
        <td>0.04</td>
        <td>0</td>
      </tr>    </table>
    
    <h2>🔧 Domain Controller Details</h2>
    <table>
      <tr>
        <th>Server</th>
        <th>Site</th>
        <th>IPv4 Address</th>
        <th>FSMO Roles</th>
        <th>DNS Service</th>
        <th>Ping Status</th>
        <th>Uptime (h)</th>
        <th>C: Free (%)</th>
        <th>C: Free (GB)</th>
      </tr>      <tr>
        <td><strong>dc01.HomeLAN.internal</strong></td>
        <td>Default-First-Site-Name</td>
        <td>10.0.0.10</td>
        <td>PDC, RID, Infrastructure, Schema, Domain Naming</td>
        <td class='pass'>Running</td>
        <td class='pass'>Online</td>
        <td>13.5</td>
        <td class='pass'>61.6%</td>
        <td class='pass'>35.93</td>
      </tr>      <tr>
        <td><strong>dc02.HomeLAN.internal</strong></td>
        <td>Default-First-Site-Name</td>
        <td>10.0.0.11</td>
        <td>None</td>
        <td class='pass'>Running</td>
        <td class='pass'>Online</td>
        <td>13.5</td>
        <td class='pass'>64.8%</td>
        <td class='pass'>37.84</td>
      </tr>    </table>
    
    <div class="chart-section">
      <div class="chart-container">
        <h2>DC Health Scores</h2>
        <canvas id="healthChart"></canvas>
      </div>
      <div class="chart-container">
        <h2>Issue Distribution</h2>
        <canvas id="issueChart"></canvas>
      </div>
    </div>
    
    <h2>Domain Controller Health Scores</h2>
    <div class="dc-health-list">      <div class="dc-health-item healthy">
        <h3>🟢 dc01.HomeLAN.internal</h3>
        <div class="score">96%</div>
      </div>      <div class="dc-health-item healthy">
        <h3>🟢 dc02.HomeLAN.internal</h3>
        <div class="score">100%</div>
      </div>    </div>
    
    <h2>Detailed Health Matrix</h2>
    <table>
      <tr>
        <th>Test</th><th>dc01.HomeLAN.internal</th><th>dc02.HomeLAN.internal</th></tr><tr><td><strong>Advertising</strong></td><td><span class='status-badge pass'>✅ PASS</span></td><td><span class='status-badge pass'>✅ PASS</span></td></tr><tr><td><strong>CheckSDRefDom</strong></td><td><span class='status-badge pass'>✅ PASS</span></td><td><span class='status-badge pass'>✅ PASS</span></td></tr><tr><td><strong>Connectivity</strong></td><td><span class='status-badge pass'>✅ PASS</span></td><td><span class='status-badge pass'>✅ PASS</span></td></tr><tr><td><strong>CrossRefValidation</strong></td><td><span class='status-badge pass'>✅ PASS</span></td><td><span class='status-badge pass'>✅ PASS</span></td></tr><tr><td><strong>DFSREvent</strong></td><td><span class='status-badge pass'>✅ PASS</span></td><td><span class='status-badge pass'>✅ PASS</span></td></tr><tr><td><strong>DiskSpace</strong></td><td><span class='status-badge pass'>✅ PASS</span></td><td><span class='status-badge pass'>✅ PASS</span></td></tr><tr><td><strong>DNSZones</strong></td><td><span class='status-badge pass'>✅ PASS</span></td><td><span class='status-badge pass'>✅ PASS</span></td></tr><tr><td><strong>FrsEvent</strong></td><td><span class='status-badge pass'>✅ PASS</span></td><td><span class='status-badge pass'>✅ PASS</span></td></tr><tr><td><strong>FSMORoles</strong></td><td>5</td><td>0</td></tr><tr><td><strong>GPOReplication</strong></td><td><span class='status-badge pass'>✅ PASS</span></td><td><span class='status-badge pass'>✅ PASS</span></td></tr><tr><td><strong>Intersite</strong></td><td><span class='status-badge pass'>✅ PASS</span></td><td><span class='status-badge pass'>✅ PASS</span></td></tr><tr><td><strong>KccEvent</strong></td><td><span class='status-badge pass'>✅ PASS</span></td><td><span class='status-badge pass'>✅ PASS</span></td></tr><tr><td><strong>KnowsOfRoleHolders</strong></td><td><span class='status-badge pass'>✅ PASS</span></td><td><span class='status-badge pass'>✅ PASS</span></td></tr><tr><td><strong>LocatorCheck</strong></td><td><span class='status-badge pass'>✅ PASS</span></td><td><span class='status-badge pass'>✅ PASS</span></td></tr><tr><td><strong>MachineAccount</strong></td><td><span class='status-badge pass'>✅ PASS</span></td><td><span class='status-badge pass'>✅ PASS</span></td></tr><tr><td><strong>NCSecDesc</strong></td><td><span class='status-badge pass'>✅ PASS</span></td><td><span class='status-badge pass'>✅ PASS</span></td></tr><tr><td><strong>NetLogons</strong></td><td><span class='status-badge pass'>✅ PASS</span></td><td><span class='status-badge pass'>✅ PASS</span></td></tr><tr><td><strong>ObjectsReplicated</strong></td><td><span class='status-badge pass'>✅ PASS</span></td><td><span class='status-badge pass'>✅ PASS</span></td></tr><tr><td><strong>Ping</strong></td><td><span class='status-badge pass'>✅ PASS</span></td><td><span class='status-badge pass'>✅ PASS</span></td></tr><tr><td><strong>Replication</strong></td><td><span class='status-badge pass'>✅ PASS</span></td><td><span class='status-badge pass'>✅ PASS</span></td></tr><tr><td><strong>Replications</strong></td><td><span class='status-badge pass'>✅ PASS</span></td><td><span class='status-badge pass'>✅ PASS</span></td></tr><tr><td><strong>RidManager</strong></td><td><span class='status-badge pass'>✅ PASS</span></td><td><span class='status-badge pass'>✅ PASS</span></td></tr><tr><td><strong>SecurityBaseline</strong></td><td><span class='status-badge pass'>✅ PASS</span></td><td><span class='status-badge pass'>✅ PASS</span></td></tr><tr><td><strong>Services</strong></td><td><span class='status-badge pass'>✅ PASS</span></td><td><span class='status-badge pass'>✅ PASS</span></td></tr><tr><td><strong>SystemErrors24h</strong></td><td class='fail'>ERROR</td><td class='pass'>3</td></tr><tr><td><strong>SystemLog</strong></td><td><span class='status-badge pass'>✅ PASS</span></td><td><span class='status-badge pass'>✅ PASS</span></td></tr><tr><td><strong>SysVolCheck</strong></td><td><span class='status-badge pass'>✅ PASS</span></td><td><span class='status-badge pass'>✅ PASS</span></td></tr><tr><td><strong>VerifyReferences</strong></td><td><span class='status-badge pass'>✅ PASS</span></td><td><span class='status-badge pass'>✅ PASS</span></td></tr></table>    
    <h2>🔐 Kerberos Delegation Details</h2>
    <div style="background: rgba(42,42,61,0.8); padding: 20px; border-radius: 12px; margin-bottom: 20px; border: 2px solid #00ffff;">
      <p style="margin-bottom: 15px; color: #e0e0e0;">
        Kerberos delegation allows services to impersonate users. Domain Controllers require unconstrained delegation by design. 
        Service accounts may use constrained delegation for specific scenarios (e.g., SQL, IIS, Exchange).
      </p>
      <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 15px; margin: 15px 0;">
        <div style="background: rgba(0,255,0,0.1); padding: 15px; border-radius: 8px; text-align: center; border: 2px solid #00ff00;">
          <div style="font-size: 0.9em; color: #00ff00; margin-bottom: 5px;">Domain Controllers</div>
          <div style="font-size: 2em; font-weight: bold; color: #00ff00;">2</div>
          <div style="font-size: 0.8em; color: #888; margin-top: 5px;">Expected & Safe</div>
        </div>
        <div style="background: rgba(255,165,0,0.1); padding: 15px; border-radius: 8px; text-align: center; border: 2px solid #ffa500;">
          <div style="font-size: 0.9em; color: #ffa500; margin-bottom: 5px;">Service Accounts</div>
          <div style="font-size: 2em; font-weight: bold; color: #ffa500;">0</div>
          <div style="font-size: 0.8em; color: #888; margin-top: 5px;">Review Required</div>
        </div>
        <div style="background: rgba(255,68,68,0.1); padding: 15px; border-radius: 8px; text-align: center; border: 2px solid #ff4444;">
          <div style="font-size: 0.9em; color: #ff4444; margin-bottom: 5px;">User Accounts</div>
          <div style="font-size: 2em; font-weight: bold; color: #ff4444;">0</div>
          <div style="font-size: 0.8em; color: #888; margin-top: 5px;">High Risk</div>
        </div>
      </div>
    </div>    <h3 style="color: #00ff00; margin-top: 30px;">✅ Domain Controllers (Expected Delegation)</h3>
    <table>
      <tr>
        <th>Account Name</th>
        <th>Type</th>
        <th>Delegation Type</th>
        <th>Risk Level</th>
        <th>Notes</th>
      </tr>      <tr>
        <td><strong>DC01</strong></td>
        <td>computer</td>
        <td><span class='status-badge pass'>Unconstrained</span></td>
        <td><span class='pass'>Expected</span></td>
        <td>Required for AD functionality</td>
      </tr>      <tr>
        <td><strong>DC02</strong></td>
        <td>computer</td>
        <td><span class='status-badge pass'>Unconstrained</span></td>
        <td><span class='pass'>Expected</span></td>
        <td>Required for AD functionality</td>
      </tr></table><h2>🔍 Issue Details & Diagnostics</h2><div class='failure-section'><h3>dc01.HomeLAN.internal (1 issue(s) detected)</h3><h4>⚠️ SystemErrors24h</h4><pre>Error checking system event log:<br>Error: Failed to query event log: No matches found<br><br>Possible causes:<br>- Event log service not running or inaccessible<br>- Insufficient permissions to read event logs<br>- Event log is corrupted or very large<br>- WinRM timeout or connection issue<br><br>Troubleshooting:<br>1. Verify Event Log service is running:<br>   Get-Service -ComputerName dc01.HomeLAN.internal -Name EventLog<br><br>2. Check WinRM connectivity:<br>   Test-WSMan -ComputerName dc01.HomeLAN.internal<br><br>3. Test manual event log access:<br>   Get-EventLog -ComputerName dc01.HomeLAN.internal -LogName System -Newest 10<br><br>4. Try alternate method:<br>   Invoke-Command -ComputerName dc01.HomeLAN.internal { Get-EventLog -LogName System -Newest 10 }<br></pre></div>    
    <script>
      // Health Score Chart
      const healthCtx = document.getElementById('healthChart').getContext('2d');
      new Chart(healthCtx, {
        type: 'bar',
        data: {
          labels: ['dc01.HomeLAN.internal','dc02.HomeLAN.internal'],
          datasets: [{
            label: 'Health Score (%)',
            data: [96,100],
            backgroundColor: ['rgba(0,255,0,0.8)','rgba(0,255,0,0.8)'],
            borderColor: ['rgba(0,255,0,0.8)','rgba(0,255,0,0.8)'],
            borderWidth: 2
          }]
        },
        options: {
          responsive: true,
          maintainAspectRatio: true,
          scales: {
            y: {
              beginAtZero: true,
              max: 100,
              ticks: { color: '#e0e0e0' },
              grid: { color: 'rgba(255,255,255,0.1)' }
            },
            x: {
              ticks: { color: '#e0e0e0' },
              grid: { color: 'rgba(255,255,255,0.1)' }
            }
          },
          plugins: {
            legend: { 
              display: true,
              labels: { color: '#e0e0e0' }
            }
          }
        }
      });
      
      // Issue Distribution Chart
      const issueCtx = document.getElementById('issueChart').getContext('2d');
      new Chart(issueCtx, {
        type: 'doughnut',
        data: {
          labels: ['Healthy', 'Critical Issues', 'Warnings'],
          datasets: [{
            data: [1, 0, 1],
            backgroundColor: [
              'rgba(0,255,0,0.8)',
              'rgba(255,68,68,0.8)',
              'rgba(255,165,0,0.8)'
            ],
            borderColor: [
              'rgba(0,255,0,1)',
              'rgba(255,68,68,1)',
              'rgba(255,165,0,1)'
            ],
            borderWidth: 2
          }]
        },
        options: {
          responsive: true,
          maintainAspectRatio: true,
          plugins: {
            legend: {
              position: 'bottom',
              labels: { color: '#e0e0e0', padding: 15, font: { size: 12 } }
            }
          }
        }
      });
    </script>
    
    <footer>
      <p>&copy; 2025 Enhanced AD Health Monitoring | Powered by PowerShell, Chart.js & HTML5</p>
      <p style="margin-top: 10px; color: #666;">
        Report generated in 18.6 seconds
      </p>
      <p style="margin-top: 15px; padding-top: 15px; border-top: 1px solid #444; color: #888;">
        Script created by <a href="https://ChrisMunnPS.github.io" target="_blank" style="color: #00ffff; text-decoration: none;">Christopher Munn</a>
      </p>
    </footer>
  </div>
</body>
</html>
